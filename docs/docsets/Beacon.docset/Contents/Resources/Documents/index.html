<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Beacon  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>
    <a title="Beacon  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Beacon 2.1.0 Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/helpscout/beacon-ios-sdk"><img src="img/gh.png"/>View on GitHub</a></p>
        <p class="header-right">
          <form role="search" action="search.json">
            <input type="text" placeholder="Search documentation" data-typeahead>
          </form>
        </p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Beacon Reference</a>
        <img id="carat" src="img/carat.png" />
        Beacon  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/HSBeacon.html">HSBeacon</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconArticleSuggestion.html">HSBeaconArticleSuggestion</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconContactForm.html">HSBeaconContactForm</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconLinkSuggestion.html">HSBeaconLinkSuggestion</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconMessagingSettings.html">HSBeaconMessagingSettings</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconSettings.html">HSBeaconSettings</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HSBeaconUser.html">HSBeaconUser</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxSessionAttributesCount">HSBeaconMaxSessionAttributesCount</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxSessionLabelLength">HSBeaconMaxSessionLabelLength</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxSessionValueLength">HSBeaconMaxSessionValueLength</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxUserAvatarLength">HSBeaconMaxUserAvatarLength</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxUserCompanyLength">HSBeaconMaxUserCompanyLength</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:HSBeaconConstants.h@HSBeaconMaxUserJobTitleLength">HSBeaconMaxUserJobTitleLength</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@HSBeaconMaximumUserAttributes">HSBeaconMaximumUserAttributes</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/HSBeaconFocusMode.html">HSBeaconFocusMode</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/HSBeaconContactFormAttachment.html">HSBeaconContactFormAttachment</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/HSBeaconDelegate.html">HSBeaconDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols.html#/c:objc(pl)HSBeaconSuggestionItem">HSBeaconSuggestionItem</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='beacon' class='heading'>Beacon</h1>

<p><a href="http://cocoapods.org/pods/Beacon"><img src="https://img.shields.io/cocoapods/v/Beacon.svg?style=flat" alt="Version"></a></p>
<h2 id='running-beacon' class='heading'>Running Beacon</h2>

<p>To get up and running on Beacon you first need to install <a href="https://brew.sh">Homebrew</a> &amp; <a href="https://bundler.io">Bundler</a>.</p>

<p>The Beacon project can be run in four steps:</p>

<ol>
<li><code>brew bundle</code></li>
<li><code>bundle install</code></li>
<li><code>fastlane setup</code> to fetch build-tool dependencies and codesigning certificates/profiles</li>
<li><code>fastlane install</code> to fetch Carthage and CocoaPods dependencies and generate the Xcode project</li>
</ol>
<h2 id='working-on-beacon' class='heading'>Working on Beacon</h2>

<p>The Beacon project consists of two major directories:</p>

<ul>
<li>The main Beacon source files</li>
<li>The Beacon example source files</li>
</ul>

<p>When adding new files to Beacon, they should be added via <code>Beacon.xcworkspace</code> in the root directory. This workspace and project file are used to build <code>Beacon.framework</code> and is what gets distributed publicly, via both Carthage and CocoaPods.</p>

<blockquote>
<p>New header files should ideally be made private, as that fact is relied on when writing unit tests, as they use a private module map.</p>
</blockquote>
<h3 id='resources' class='heading'>Resources</h3>

<p>New resources, such as storyboard files, should be added in the BeaconResources directories. XcodeGen will pick them up and include them when running <code>fastlane install</code>.</p>
<h2 id='releasing-beacon' class='heading'>Releasing Beacon</h2>

<p>Fastlane manages releasing a new version of the Beacon SDK with <code>fastlane release</code>. This will:</p>

<ul>
<li>Update the version numbers of the framework and example app</li>
<li>Committing the version changes and pushing them to GitHub</li>
<li>Building the Beacon framework and adding it to a new GitHub release</li>
<li>Building the example app and uploading it to TestFlight</li>
</ul>

<p>The <code>fastlane release</code> command will <em>not</em> push a new public version.</p>

<blockquote>
<p>Before pushing a release of Beacon, it is worth removing the existing <code>Carthage</code> directory – Carthage may keep files from previous builds, rather than deleting any files that no longer exist.</p>
</blockquote>
<h2 id='releasing-beacon-publicly' class='heading'>Releasing Beacon Publicly</h2>

<p>Before making the final public updates, be sure to get sign off on the <a href="https://helpscout.slab.com/posts/i-os-sdk-release-notes-r6bjw5qz">iOS SDK Release Notes</a> page on Slab and subsequently update <code>CHANGELOG.md</code> with the release notes.  After updating the release notes, you can continue with a new public release:</p>

<ol>
<li><code>fastlane copy_framework</code></li>
<li><code>fastlane create_public_github_release</code></li>
</ol>

<blockquote>
<p>After copying the framework, check the git diff to ensure that the changes look correct.</p>
</blockquote>
<h2 id='updating-the-jazzy-docs' class='heading'>Updating the Jazzy Docs</h2>

<p>Beacon uses <a href="https://github.com/realm/jazzy">Jazzy</a> to generate documentation for Beacon&rsquo;s publically available header files. This documentation is included as part of the <a href="https://github.com/helpscout/beacon-ios-sdk/tree/master/docs">public repo</a> and as part of the <a href="https://developer.helpscout.com/beacon-2/ios-api/index.html">developer site</a>.  To generate the docs you can run the following command in either your local <code>beacon-ios-sdk-private</code> repository (assuming you have a local Beacon.framework)</p>

<p><code>fastlane document</code></p>

<p>This command will generate a <code>docs</code> directory that you can then use to update the <a href="https://github.com/helpscout/beacon-ios-sdk">public repo</a> and the <a href="https://github.com/helpscout/developer">developer repo</a></p>
<h2 id='authentication' class='heading'>Authentication</h2>

<p>Most Fastlane commands require authentication of some sort, either with GitHub or TestFlight.</p>

<ul>
<li>GitHub authenticates using a <code>GITHUB_TOKEN</code> environment variable</li>
<li>TestFlight will ask you for authentication when you run the release command</li>
</ul>

<hr>
<h2 id='push-notification-documentation' class='heading'>Push Notification Documentation</h2>

<p>With Beacon push notifications, we want to register our device token as early as possible. This can be handled either by us or by the developer integrating the SDK, but all that matters here is that the token is sent by the time the user sends a message via Beacon.</p>

<p>Once a message is sent (either via replying to a thread directly or starting a new conversation), we call the API for subscribing to notifications for a conversation ID. The idea here is that the user will only receive notifications for threads on the last device they used to interact.</p>

<p>After registering the push token and subscribing to a conversation, we have to handle push notifications when they come in.</p>

<hr>
<h2 id='updating-dependencies' class='heading'>Updating Dependencies</h2>

<p>As of Beacon 2.0.0, Beacon no longer has public dependencies.  Instead it&rsquo;s dependencies source files are privately included as part of the framework.  This was done for a few reasons, primarily, so that clients could use the Manual integration option for Beacon, without having to use Cocoapods or Carthage to build Beacon&rsquo;s dependencies.  Some other reasons, allowing us to maintain Swift version compatibility, and to better align with how we distribute Beacon itself, as a closed source <a href="https://github.com/Carthage/Carthage/blob/master/Documentation/Artifacts.md#binary-only-frameworks">binary framework</a>. These are some tips for when we need to update those dependencies.</p>

<ol>
<li>Get the source code from a tagged release (e.g. <a href="https://github.com/pusher/pusher-websocket-swift/releases/tag/8.0.0">https://github.com/pusher/pusher-websocket-swift/releases/tag/8.0.0</a>).</li>
<li>Delete the extra files (e.g. Tests, .travis.yml, .git) and only include the Sources directory.</li>
<li>If you&rsquo;re updating Pusher Websocket Swift, we&rsquo;re currently using PusherWithoutEncryption so choose that version of the PusherDecryptor (this also means we don&rsquo;t need to include Sodium as a dependency).</li>
<li>Include a VERSION file that has the name of the dependency and the tagged version # from step 1.</li>
</ol>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/helpscout" target="_blank" rel="external">Help Scout</a>. All rights reserved. (Last updated: 2020-10-29)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.5</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
